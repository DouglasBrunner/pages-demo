{%- comment -%}
  Assumptions:
  - Each page belongs to a collection whose name is provided in page.collection
    (or defaults to "specification" if not set).
  - The base path is automatically constructed as "/" + collection name + "/".
{%- endcomment -%}

{% assign url_parts = page.url | split: "/" | where_exp:"item", "item != ''" %}
{% assign breadcrumb = "" | split: "" %}
{% for part in url_parts %}
  {% assign breadcrumb = breadcrumb | push: part %}
{% endfor %}

{% comment %}
  Now, we convert the breadcrumb array to cumulative URL paths.
  For example, if breadcrumb is:
  ["specification", "imap", "connectivity.html"],
  the output will be:
  "/specification/", "/specification/imap/", "/specification/imap/connectivity.html"
{% endcomment %}

{% assign cumulative = "" %}
{% for part in breadcrumb %}
  {% unless forloop.first %}
    <span> -> </span>
  {% endunless %}
  {% assign cumulative = cumulative | append: part %}
  {% assign part_url = cumulative %}
  {% assign cumulative = cumulative | append: "/" %}
  <a href="{{ part_url | relative_url }}">{{ part }}</a>
{% endfor %}
